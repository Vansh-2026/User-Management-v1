#!/usr/bin/env node
"use strict";var e=require("yargs"),t=require("yargs/helpers"),n=require("child_process"),o=require("readline"),r=require("crypto"),s=require("util"),i=require("fs"),a=require("jsonwebtoken"),c=require("path"),u=require("os"),l=require("glob"),d=require("https"),p=require("http"),h=require("url");function f(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var m=f(c);const w=["TELERIK_LICENSE","KENDO_UI_LICENSE"],g="telerik-license.txt",y=[g,"kendo-ui-license.txt"],E="TELERIK_LICENSING_APIENDPOINTADDRESS",I="localhost",T="/callback",C=3e5,v="https://prgress.co/3PxpDaP",U=["KENDOUIANGULAR","KENDOUICOMPLETE","KENDOUIREACT","KENDOUIVUE"],k=["TF_BUILD","GITHUB_ACTIONS","GITLAB_CI","bamboo.buildKey","BUILDKITE","CIRCLECI","CIRRUS_CI","CODEBUILD_BUILD_ID","HEROKU_TEST_RUN_ID","TEAMCITY_VERSION","TRAVIS","BUILDER_OUTPUT","GERRIT_PROJECT","SYSTEM_TEAMFOUNDATIONCOLLECTIONURI","BITRISE_IO","BUDDY_WORKSPACE_ID","APPVEYOR","CIRCLECI","SEMAPHORE","DRONE","DSARI","TDDIUM","SCREWDRIVER","STRIDER","TASKCLUSTER_ROOT_URL","JENKINS_URL","GO_PIPELINE_NAME","HUDSON_URL","WERCKER","NETLIFY","NOW_GITHUB_DEPLOYMENT","GITLAB_DEPLOYMENT","BITBUCKET_DEPLOYMENT","BITBUCKET_BUILD_NUMBER","NOW_BUILDER","VERCEL_GITLAB_DEPLOYMENT","VERCEL_BITBUCKET_DEPLOYMENT","VERCEL_URL","MAGNUM","NEVERCODE","RENDER","SAIL_CI","SHIPPABLE","TEAMCITY_VERSION","BUILD_ID","CI_NAME","CI"];var L;!function(e){e.BLAZOR="BLAZOR",e.DPL="DPL",e.JM="JM",e.KENDOUIANGULAR="KENDOUIANGULAR",e.KENDOUICOMPLETE="KENDOUICOMPLETE",e.KENDOUIMVC="KENDOUIMVC",e.KENDOUIREACT="KENDOUIREACT",e.KENDOUIVUE="KENDOUIVUE",e.MAUI="MAUI",e.RCAJAX="RCAJAX",e.RCWF="RCWF",e.RCWPF="RCWPF",e.REPORTING="REPORTING",e.REPORTSERVER="REPORTSERVER",e.UIASPCORE="UIASPCORE",e.UIXAM="UIXAM",e.WINUI="WINUI"}(L||(L={}));const N=Object.freeze({[L.BLAZOR]:"Telerik UI for Blazor",[L.DPL]:"Telerik Document Processing",[L.JM]:"Telerik JustMock",[L.KENDOUIANGULAR]:"Kendo UI for Angular",[L.KENDOUICOMPLETE]:"Kendo UI for jQuery",[L.KENDOUIMVC]:"Telerik UI for ASP.NET MVC",[L.KENDOUIREACT]:"KendoReact",[L.KENDOUIVUE]:"Kendo UI for Vue",[L.MAUI]:"Telerik UI for .NET MAUI",[L.RCAJAX]:"Telerik UI for ASP.NET AJAX",[L.RCWF]:"Telerik UI for WinForms",[L.RCWPF]:"Telerik UI for WPF",[L.REPORTING]:"Telerik Reporting",[L.REPORTSERVER]:"Telerik Report Server",[L.UIASPCORE]:"Telerik UI for ASP.NET Core",[L.UIXAM]:"Telerik UI for Xamarin",[L.WINUI]:"Telerik UI for WinUI"}),R=Object.freeze({perpetual:"Perpetual license",subscription:"Subscription license",trial:"Trial license"}),b=e=>Boolean(e)&&!["0","false","no"].includes(e.trim().toLowerCase()),O=(e,t,n)=>`${((e,t)=>`[${e}][Telerik and Kendo UI Licensing]`+(t?` ${t}:`:""))(e,n)} ${t}`,A=(e,t)=>console.warn(O("WARN",e,t)),P=(e,t)=>console.error(O("ERROR",e,t)),$=e=>console.log(O("INFO",e)),S=(e,t)=>{b(process.env.TELERIK_LICENSING_DEBUG)&&console.log(O("DEBUG",e,t))};function D(e){return Math.floor(e.getTime()/1e3)}function _(){return D(new Date)}function x(e){const t=_()-D(e);return Math.floor(t/86400)}function K(e){const t=function(e){if("function"==typeof atob)return atob(e);if("function"==typeof Buffer)return Buffer.from(e,"base64").toString("utf8");throw new Error("atob is undefined")}(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}function B(e){const t=e.split(".")[1],n=String.fromCharCode(...(o=t,K(o.replace(/-/g,"+").replace(/_/g,"/"))));var o;return JSON.parse(n)}function M(e){return new Date(1e3*e)}function j(e,t){const n=M(t);return e>new Date(n.getFullYear(),n.getMonth(),n.getDate()+1).getTime()/1e3}function V(e,t){const n=t.filter(e=>"usage"!==e.type).filter(t=>e.productCode===t.code||e.redistributedBy?.includes(t.code)||e.productCodes?.includes(t.code)).sort((e,t)=>t.expiration-e.expiration);return n.find(e=>"subscription"===e.type&&!j(_(),e.expiration))||n.find(t=>"perpetual"===t.type&&!j(e.publishDate,t.expiration))||n.find(e=>"subscription"===e.type&&!j(function(e,t){const n=new Date(1e3*e);return n.setDate(n.getDate()+t),D(n)}(_(),10),e.expiration))||n.find(e=>"trial"===e.type&&!j(_(),e.expiration))||n.find(e=>"subscription"===e.type)||n.find(e=>"perpetual"===e.type)||n.find(e=>"trial"===e.type)}const F=e=>e.productCode||e.productCodes[0],W="https://licensing.telerik.com",z=W+"/api/v1/key",H=W+"/api/v1/usage",G="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2mnUVMmkth2x+N/ODszG\nOFIYBL6NOO1XWRj1wkmecKuLziJDhFz0WQmyOjY34Ymg9pLuBA9QSWrrZuvPw40N\nm0X/GBmttFmPNvca3WmJ2oKM7PpLiUU9f7Ov5WeIXnx++ts/LC/OB7FtZ+LiRgJ7\n0mZnPeTogdFrASf0zSQJv4jmX840LPa6nomWeUgIVGPLLVI14Gib8Dl+nOckqCNc\nkAUUk4IBF67DufRt9zQyRxg99ysakvHX2SDbdGvIBdxWxvhhmrBoeix0uSVtG2gm\njdvSqlPJVdvMbk1Xe2+SUldJPrxH1VrTYeRUt4yqWxy16nFJUDj9exZ202X4THkU\nJQIDAQAB\n-----END PUBLIC KEY-----",q=Object.freeze({CLIENT_ID:"kendo.licensing.cli.v1",CLIENT_SECRET:"349c875fc2d084006df60ae4b7b63c0d",AUTHORIZATION_URL:"https://identity.telerik.com/login",TOKEN_URL:"https://identity.telerik.com/v2/oauth/telerik/token",CALLBACK_PATH:"/callback"}),J=s.promisify(n.exec),Y=i.promises.readFile;function X(e){const t=Buffer.alloc(16);for(let n=0;n<16;n++)t[n]=e[n]^e[n+16];function n(e,n){let o="";for(let r=e;r<=n;r++)o+=t[r].toString(16).padStart(2,"0");return o}return`${n(0,3)}-${n(4,5)}-${n(6,7)}-${n(8,9)}-${n(10,15)}`}async function Q(){try{switch(process.platform){case"win32":return await async function(){const e=n.spawn("powershell.exe",["-nologo","-Command","$BIOS = @(Get-WmiObject Win32_BIOS | Select-Object -Property Manufacturer, SerialNumber, Name);$Product = @(Get-WmiObject Win32_ComputerSystemProduct | Select-Object -Property UUID);New-Object -TypeName PSObject -Property @{    'BIOS' = $BIOS;    'Product' = $Product;} | ConvertTo-JSON"]);let t="";const s=o.createInterface(e.stdout);for await(const e of s)t=""==t?e:t+"\n"+e;const i=JSON.parse(t);let a="Telerik Licensing\nWorkstation Id Fingerprint\n";function c(e){null!=e&&""!=e&&(a+=e+";")}a+="BIOS:\n";for(const e of i.BIOS)a+="  - ",c(e.Manufacturer),c(e.SerialNumber),c(e.Name),a+="\n";a+="Product:\n";for(const e of i.Product)a+="  - ",c(e.UUID),a+="\n";const u=r.createHash("sha256");u.update(a);const l=X(u.digest());return{fingerprint:a,id:l}}();case"darwin":return await async function(){const e=(await J("ioreg -rd1 -w0 -c IOPlatformExpertDevice"))?.stdout?.toString(),{platformUUID:t}=e.match(/"IOPlatformUUID"\s=\s"(?<platformUUID>[0-9A-F-]*)"/).groups,{platformSN:n}=e.match(/"IOPlatformSerialNumber"\s=\s"(?<platformSN>[^"]*)"/).groups,o=(await J("sysctl hw.model"))?.stdout?.toString(),{hardwareModel:s}=o.match(/^hw.model:\s(?<hardwareModel>.*)$/m).groups,i=`Telerik Licensing\nWorkstation Id Fingerprint\nPlatform UUID: ${t}\nPlatform S/N: ${n}\nHardware model: ${s}\n`,a=r.createHash("sha256");return a.update(i),{fingerprint:i,id:X(a.digest())}}();case"linux":return await async function(){let e="";try{e=(await Y("/etc/machine-id"))?.toString()?.trim()||""}catch{}try{e=e||(await Y("/var/lib/dbus/machine-id"))?.toString()?.trim()||""}catch{}let t="";try{t=(await Y("/sys/devices/virtual/dmi/id/bios_vendor"))?.toString()?.trim()||""}catch{}let n="";try{n=(await Y("/sys/devices/virtual/dmi/id/board_vendor"))?.toString()?.trim()||""}catch{}let o="";try{o=(await Y("/sys/devices/virtual/dmi/id/chassis_vendor"))?.toString()?.trim()||""}catch{}const s=`Telerik Licensing\nWorkstation Id Fingerprint\nMachine Id: ${e}\nBIOS Vendor: ${t}\nBoard Vendor: ${n}\nChassis Vendor: ${o}\n`,i=r.createHash("sha256");return i.update(s),{fingerprint:s,id:X(i.digest())}}();default:throw new Error(`Platform ${process.platform} not supported.`)}}catch(e){return{fingerprint:"<error>",id:"00000000-0000-0000-0000-000000000000"}}}let Z;function ee(){return Z||(Z=Q())}function te(e){const t=process.env[e];return t&&"false"!==t.toLowerCase()}function ne(){if(te("TF_BUILD"))return"Azure Pipelines";if(te("GITHUB_ACTIONS"))return"GitHub Actions";for(const e of k)if(te(e))return"Other"}function oe(e,t){return new Promise((n,o)=>{a.verify(e,t,{algorithms:["RS256"]},function(e,t){e&&o(e),n(t)})})}async function re(e,t){const n=await oe(e,t);return n.licenses?.length>0&&await Promise.all(n.licenses.map(e=>oe(e,t))),n}class se extends Error{constructor(e,t,n){super(e),this.name=this.constructor.name,this.exitCode=t,this.suggestion=n,"captureStackTrace"in Error&&Error.captureStackTrace(this,this.constructor)}}class ie extends se{constructor(e,t){super(e,4,t||"Please check your credentials and try again.")}}class ae extends se{constructor(e,t){super(e,5,t||"Check your internet connection and try again.")}}class ce extends se{constructor(e,t){super(e,3,t||"Run with --help for usage information.")}}class ue extends se{constructor(e,t){super(e,4,t||"Try again to complete authentication.")}}class le extends se{constructor(e,t){super(e,3,t||"Check file permissions and disk space.")}}function de(){const e=u.homedir();if("win32"===u.platform()){const t=process.env.APPDATA||c.join(e,"AppData","Roaming");return c.join(t,"Telerik")}return c.join(e,".telerik")}async function pe(e){try{await i.promises.mkdir(e,{recursive:!0})}catch(t){throw new le(`Failed to create directory ${e}: ${t.message}`)}}async function he(e,t){const n=c.dirname(e);try{await pe(n);if(!await async function(e){try{return await i.promises.access(e,i.promises.constants.W_OK),!0}catch{return!1}}(n))throw new le(`Permission denied writing to ${e}`);await i.promises.writeFile(e,t,"utf8")}catch(t){if(t instanceof le)throw t;throw"EACCES"===t.code?new le(`Permission denied writing to ${e}`):"ENOSPC"===t.code?new le("Insufficient disk space to write license file"):"ENOENT"===t.code?new le(`Directory does not exist: ${n}`):new le(`Failed to write file ${e}: ${t.message}`)}}async function fe(e){if(!await async function(e){try{return await i.promises.access(e),!0}catch{return!1}}(e))return null;const t=`${e}.bak`;try{const n=await async function(e){try{return await i.promises.readFile(e,"utf8")}catch(t){throw"ENOENT"===t.code?new le(`File not found: ${e}`):"EACCES"===t.code?new le(`Permission denied reading file: ${e}`):new le(`Failed to read file ${e}: ${t.message}`)}}(e);return await he(t,n),t}catch(t){throw new le(`Failed to create backup of ${e}: ${t.message}`)}}async function me(e){try{const t=await i.promises.stat(e);return{size:t.size,isDirectory:t.isDirectory()}}catch(e){return{size:0,isDirectory:!1}}}async function we(e,t){const n=new AbortController,o=setTimeout(()=>n.abort(),t.timeout);try{const r=await fetch(e,{method:t.method,headers:t.headers,body:t.body,signal:n.signal});clearTimeout(o);const s=await r.text(),i={};return r.headers.forEach((e,t)=>{i[t]=e}),{status:r.status,statusText:r.statusText,headers:i,body:s}}catch(e){if(clearTimeout(o),"AbortError"===e.name)throw new Error(`Request timed out after ${t.timeout}ms`);throw e}}const ge={method:"GET",headers:{},timeout:3e4,retries:3,retryDelay:1e3};async function ye(e,t={}){const n={...ge,...t};let o;for(let t=0;t<n.retries;t++)try{return await we(e,n)}catch(r){o=r;const s=n.retryDelay*Math.pow(2,t);A(`Network error during ${n.method?.toUpperCase()} ${e}`),$(`Retrying in ${s/1e3} seconds (attempt ${t+1}/${n.retries})...`),await Ee(s)}const r=o?o.message:"Unknown error";throw new ae(`Failed to ${n.method?.toLowerCase()} ${e}: ${r}`)}function Ee(e){return new Promise(t=>setTimeout(t,e))}async function Ie(e){const{accessToken:t,outputPath:n}=e;if(!t)throw new se("Access token is required",4,"Complete OAuth authentication first");try{$("Downloading license key...");const e=await async function(e){const t=z;S(`Fetching license from ${t}`);const n=await async function(e,t={}){return ye(e,{...t,method:"GET"})}(t,{headers:{Authorization:`Bearer ${e}`,Accept:"text/plain"},timeout:3e4});if("string"==typeof n.body&&200===n.status)return n.body;const o=n.status;if(401===o)throw new se("Authentication failed - access token is invalid or expired",4,"Please re-authenticate with the refresh command");if(403===o)throw new se("Access forbidden - insufficient token permissions",4,"The license client may be outdated. Please update and try again.");if(429===o)throw new ae("Rate limit exceeded","Wait a few minutes before trying again");if(o>=500)throw new ae(`License server error (${o})`,"Try again later or contact support if the problem persists");throw new ae(`Unable to fetch key from license API. Server responded with ${o}`,"Please try again later")}(t),o=await async function(e){if(!e){const e=de();return m.join(e,g)}const t=await me(e);if(t.isDirectory||e.endsWith("/")||e.endsWith(m.sep))return m.join(e,g);return e}(n),r={content:e,filename:m.basename(o),filepath:o,size:Buffer.byteLength(e,"utf8"),downloadedAt:new Date};await async function(e){if(!e.content||0===e.content.trim().length)throw new Error("License content cannot be empty");if(!e.filepath||0===e.filepath.trim().length)throw new Error("License file path cannot be empty");const t=await re(e.content,G).catch(()=>null);if(null==t)throw S("License key content does not appear to be valid: "+e.content),new Error("License key content is not valid")}(r),S(`Saving license to: ${o}`),await async function(e,t){try{const n=m.dirname(t);await pe(n),await fe(t),await he(t,e.content),S(`License file written: ${t}`)}catch(e){throw new le(`Failed to save license to ${t}: ${e.message}`,"Check file permissions and disk space")}}(r,o);return{licenseKey:r,filePath:o,fileSize:(await me(o)).size,downloadedAt:r.downloadedAt}}catch(e){if(e instanceof se)throw e;throw new se(`Failed to download license: ${e.message}`,5,"Check your internet connection and try again")}}function Te(){const e=process.env.INIT_CWD||process.cwd();return c.resolve(e)}function Ce(){const e=Te().split(c.sep),t=[],n=process.env.TELERIK_LICENSE_PATH;if(n&&n.length>0)return[n];for(let n=0;n<e.length;n++){const o=e.slice(0,e.length-n).join(c.sep);t.push(o||c.sep)}return t.push(de()),t.flatMap(e=>y.map(t=>c.join(e,t)))}function ve(e){try{const t=i.readFileSync(e,{encoding:"utf-8"});return JSON.parse(t)}catch(e){return{}}}const Ue=/@(progress|telerik)\/[^/@"]+/,ke=e=>e.match(Ue)?.[0],Le=e=>Ue.test(e);function Ne(e){const t=function(e){const t=ve(c.join(e,"package-lock.json")).packages||{},n=new Map;for(const e of Object.keys(t)){const o=t[e],r=ke(e);r&&Boolean(o.version)&&n.set(r,o.version)}return n}(e),n=function(e){let t="";try{t=i.readFileSync(c.join(e,"yarn.lock"),{encoding:"utf-8"})}catch(e){}const n=new Map,o=t.split("\n");return o.forEach((e,t)=>{const r=e.startsWith('"@progress/')||e.startsWith('"@telerik/'),s=ke(e);if(r&&s&&t<o.length-1){const e=o[t+1],r=e.match(/version[\s:]+"?([.\d]+)"?/)?.[1];r&&n.set(s,r)}}),n}(e),o=function(...e){const t=new Map;for(const n of e)for(const[e,o]of n.entries())t.set(e,o);return t}(t,n),r=ve(c.join(e,"package.json")),s={...r.dependencies,...r.devDependencies};for(const e of Object.keys(s)){const t=s[e];Le(e)&&Boolean(t)&&o.set(e,t)}return o}const Re=[{match:e=>"@progress/kendo-ui"===e,code:L.KENDOUICOMPLETE,name:N.KENDOUICOMPLETE},{match:e=>e.startsWith("@progress/kendo-angular-"),code:L.KENDOUIANGULAR,name:N.KENDOUIANGULAR},{match:e=>e.startsWith("@progress/kendo-react-"),code:L.KENDOUIREACT,name:N.KENDOUIREACT},{match:e=>e.startsWith("@progress/kendo-vue-"),code:L.KENDOUIVUE,name:N.KENDOUIVUE}],be=e=>e.replace(/^[~^v><= ]+/g,"");function Oe(e){let t;const n=Te();try{t=require.resolve(e+"/package.json",{paths:[n]})}catch(o){const[r,s]=e.split("/");t=c.join(n,"node_modules",r,s,"package.json")}return t}function Ae(e){return Boolean(e&&(e.productCode||e.productCodes?.length>0))}async function Pe(e){const t=Ne(e).keys(),n=[];for(const e of t){const t=Oe(e),o=c.dirname(t),r=ve(t);let s=r["@progress"]?.package;if(Ae(s))s.name=r.name,s.version=r.version,n.push(s);else{const e=[c.join(o,"esm2022","package-metadata.mjs"),c.join(o,"package-metadata.mjs")];let t;for(;!t&&e.length>0;)t=await import(e.shift()).catch(()=>{});if(t&&t.packageMetadata&&Ae(t.packageMetadata)){s=t.packageMetadata;const e=s.version||r.version;n.push({...s,version:e})}}}return n}function $e(e){const t=new Map;for(const n of e){const e=F(n);let o;t.has(e)?o=t.get(e):(o=new Map,t.set(e,o)),o.has(n.version)||o.set(n.version,{...n,name:"<group>"})}return[...t.values()].flatMap(e=>[...e.values()])}function Se(){const e=function(){for(const e of Ce())try{return i.accessSync(e,i.constants.R_OK),e}catch(e){}return null}();if(null!==e){return{success:!0,source:e,value:i.readFileSync(e,{encoding:"utf-8"}).trim()}}return{success:!1,message:Ce().map(e=>`* ${e}`).join("\n")}}function De(){const e=function(){for(const e of w){const t=process.env[e];if(t&&t.length>0)return{success:!0,source:e,value:t.trim()}}return{success:!1,message:`* Environment Variables: ${w.join(", ")}\n`}}();if(!0===e.success)return e;const t=Se();return!0===t.success?t:{success:!1,message:"No Telerik and Kendo UI License file found.\n\nThe following locations were searched:\n"+e.message+t.message+"\n\nTo download a license key file, visit https://prgress.co/3PBSVoC"}}function _e(e,t){const n=`${e}: `,o=M(t.expiration),r=-x(o);"subscription"===t.type?$(n+`Your ${e} subscription is active. `+`Expiration in ${r} days - ${o.toLocaleDateString()}.`):"trial"===t.type?$(n+`Your ${e} trial expires in ${r} days.`):"perpetual"===t.type&&$(n+"Valid license found.")}class xe{constructor(e,t){this.productName=e,this.severity="WARN",this.code="TKL101",this.licenseEvidence=null,this.message=`${e} is not listed in your current license file.\n  Learn more about ${e} licensing at ${t}`}}class Ke{constructor(e,t,n,o,r){this.productName=e,this.licenseEvidence=t,this.severity="WARN",this.code="TKL102",this.message=`Your current license has expired on ${n.toLocaleDateString()} and is not valid for ${e} version ${o}. The product was published on ${r.toLocaleDateString()}.\n  Renew your license at https://prgress.co/3PwQNi1`}}class Be{constructor(e,t,n){this.productName=e,this.licenseEvidence=t,this.severity="WARN",this.code="TKL103",this.message=`Your subscription has expired ${n} days ago.\n  Renew your maintenance and support to enjoy uninterrupted service at https://prgress.co/3PwQMut`}}class Me{constructor(e,t,n){this.productName=e,this.licenseEvidence=t,this.severity="WARN",this.code="TKL104",this.message=`Your subscription has expired ${n} days ago.\n  Renew your maintenance and support to enjoy uninterrupted service at https://prgress.co/3PwQMut`}}class je{constructor(e,t,n){this.productName=e,this.licenseEvidence=t,this.severity="WARN",this.code="TKL105",this.message=`Your trial has expired ${n} days ago.\n  Thank you for trying out ${e}, we hope you enjoyed your trial period.\n  To continue using our product, consider upgrading to a commercial license: https://prgress.co/3PwQMdX`}}const Ve=e=>{let t=(e.licenses||[]).map(e=>B(e));return 0===t.length&&e.products&&(t=(e.products||[]).map(t=>({type:t.trial?"trial":"perpetual",code:t.code,expiration:t.licenseExpirationDate,licenseId:e.licenseId,userId:e.userId}))),t};function Fe(e,t){const n=e.licenses||[],o=Ve(e),r=o.findIndex(e=>"usage"===e.type),s=-1!==r?n[r]:null,i=$e(t),a=new Map,c=new Map,u=new Map;for(const e of i){const t=e.productCode||e.productCodes[0],n=V(e,o);if(n)if("subscription"===n.type&&j(_(),n.expiration)){const o=x(M(n.expiration));o>10?c.set(t,new Be(e.productName,n,o)):c.set(t,new Me(e.productName,n,o))}else if("perpetual"===n.type&&j(e.publishDate,n.expiration))c.set(t,new Ke(e.productName,n,M(n.expiration),e.version,M(e.publishDate)));else if("trial"===n.type&&j(_(),n.expiration)){const o=x(M(n.expiration));c.set(t,new je(e.productName,n,o))}else a.has(n.code)||(a.set(n.code,n),u.set(n.code,e.productName));else c.set(t,new xe(e.productName,e.licensingDocsUrl))}return{productErrors:c,productLicenses:a,productVersions:i,productNames:u,usageEvidence:s}}function We(e,t){const n=Te(),o=[c.join(c.join(__dirname,"../dist"),"index*.{js,mjs}"),c.join(n,".angular/cache/**/vite/deps*/chunk-*.js"),c.join(n,".angular/cache/**/vite/deps*/@progress*.js"),c.join(n,".next/static/chunks/*.js"),c.join(n,"node_modules/.vite/deps/chunk-*.js"),c.join(n,"node_modules/.vite/deps/@progress*.js")].map(e=>e.replace(/\\/g,"/")),r=function(e,t){const n=(e.licenses||[]).filter(e=>{const n=B(e);return"usage"!==n.type&&t.includes(n.code)});return{products:n.length>0?[]:e.products||[],licenses:n,userId:e.userId,integrity:e.integrity,scriptKey:!1,timestamp:e.iat}}(e,t),s=JSON.stringify(JSON.stringify(r)),a=`  ${s.substring(1,s.length-1)}  `;S(JSON.stringify(r)),l.globSync(o,{nodir:!0}).forEach(e=>{const t=i.readFileSync(e,{encoding:"utf-8"}).replace(/ {2}{.*} {2}/,a);i.writeFileSync(e,t,{encoding:"utf-8"})})}const ze=s.promisify(n.exec);function He(){const e=process.platform;return"win32"===e?"win32":"darwin"===e?"darwin":"linux"===e?"linux":"unknown"}async function Ge(e){const{url:t}=e;if(!t||!function(e){try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch{return!1}}(t))throw new se(`Invalid URL: ${t}`,3,"Provide a valid HTTP or HTTPS URL");try{S(`Opening URL in browser: ${t}`);const e=function(e){const t=He();switch(t){case"win32":return`start "" "${e}"`;case"darwin":return`open "${e}"`;case"linux":return`xdg-open "${e}" || gnome-open "${e}" || kde-open "${e}"`;default:throw new se(`Unsupported platform: ${t}`,3,"Please open the URL manually in your browser")}}(t);return S(`Executing command: ${e}`),await ze(e),S("Browser opened successfully"),!0}catch(e){return S(`Failed to open browser: ${e.message}`),!1}}function qe(e){const t="━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━";console.log("\n"+t),console.log("  Please open this URL in your browser:"),console.log(t+"\n"),console.log(`  ${e}\n`),console.log(t),console.log(`  ${function(){switch(He()){case"win32":case"linux":return"Copy the URL and paste it into your browser's address bar";case"darwin":return"Copy the URL (Cmd+C) and paste it into your browser's address bar";default:return"Open the URL in your web browser"}}()}`),console.log(t+"\n")}const Je=()=>b(process.env.TELERIK_TELEMETRY_INTERNAL);async function Ye({url:e,payload:t,timeout:n}){const o=e.port?Number.parseInt(e.port,10):void 0,r={protocol:e.protocol,hostname:e.hostname,port:o,path:e.pathname,timeout:n,method:"POST",headers:{"Content-Type":"application/json"}};return new Promise((e,n)=>{const o=(e=>"https:"===e.protocol?d.request(e):p.request(e))(r);o.on("error",e=>{n(e)}),o.on("timeout",()=>{n(new Error("Request timeout"))}),o.on("close",()=>{e()}),o.end(JSON.stringify(t))})}async function Xe(e){return Ye({url:new URL(process.env[E]||H),payload:e,timeout:3e3})}async function Qe(e,t,n){const{id:o}=await ee(),r=M(e.expiration).toISOString().split(".")[0]+"Z",s=function(e){if(void 0!==e)return null===e?null:{Type:e.type,CI:e.CI,UserId:e.userId,LicenseId:e.licenseId,WorkstationId:e.workstationId,ProductCode:e.productCode,ProductLicenseType:e.productLicenseType,ProductLicenseValidity:e.productLicenseValidity,ProductVersion:e.productVersion,UsageEvidence:e.usageEvidence,IsInternalUsage:e.isInternalUsage}}({type:"LicenseUsed",userId:e.userId,licenseId:e.licenseId,workstationId:o,productCode:e.code,productLicenseType:e.type,productLicenseValidity:r,productVersion:n,usageEvidence:t,isInternalUsage:!!Je()||void 0,CI:ne()});S("LicenseUsed: "+JSON.stringify(s,null,2)),await Xe(s).catch(e=>{S(`Failed to send telemetry: ${e}`)})}async function Ze({licenseKey:e,licenseEvidence:t,licenseErrorCode:n,usageEvidence:o,productVersion:r,productCode:s}){const{id:i}=await ee(),a=t?M(t.expiration).toISOString().split(".")[0]+"Z":void 0,c=function(e){if(void 0!==e)return null===e?null:{Type:e.type,ProductCode:e.productCode,ProductVersion:e.productVersion,LicenseErrorCode:e.licenseErrorCode,ProductLicenseType:e.productLicenseType,ProductLicenseValidity:e.productLicenseValidity,LicenseId:e.licenseId,UserId:e.userId,WorkstationId:e.workstationId,CI:e.CI,IsInternalUsage:e.isInternalUsage,UsageEvidence:e.usageEvidence}}({type:"LicenseNotValid",productCode:s,productVersion:r,licenseErrorCode:n,productLicenseType:t?.type,productLicenseValidity:a,licenseId:e.licenseId,userId:e.userId,workstationId:i,CI:ne(),isInternalUsage:!!Je()||void 0,usageEvidence:o});S(`Workstation ID: ${i}`),S("LicenseNotValid: "+JSON.stringify(c,null,2)),await Xe(c).catch(e=>{S(`Failed to send LicenseNotValid telemetry: ${e}`)})}const et=()=>(process.env[E]||H).replace("/usage","/collect");async function tt({productVersion:e,productCode:t}){const{id:n}=await ee(),o=function(e){if(void 0!==e)return null===e?null:{Type:e.type,ProductCode:e.productCode,ProductVersion:e.productVersion,WorkstationId:e.workstationId,CI:e.CI,IsInternalUsage:e.isInternalUsage}}({type:"LicenseNotFound",productCode:t,productVersion:e,workstationId:n,CI:ne(),isInternalUsage:!!Je()||void 0});S("LicenseNotFound: "+JSON.stringify(o,null,2)),await async function(e){return Ye({url:new URL(et()),payload:e,timeout:3e3})}(o).catch(e=>{S(`Failed to send telemetry: ${e}`)})}const nt={command:"activate",describe:`Validates and imports a Telerik and Kendo UI license key file.\n\nThe following locations are searched for a license key:\n* The path specified in the \${LICENSE_ENV_PATH_VAR} environment variable.\n* The ${w.join(", ")} environment variables.\n* The ${y.join(", ")} files in:\n    * The current working directory\n    * Each parent directory\n    * ~/\${TELERIK_HOME_DIR} (Linux and macOS) or %APPDATA%\\\${TELERIK_HOME_DIR_WIN32} (Windows)`,builder:function(e){return e.option("ignore-no-license",{type:"boolean",description:"Sets the exit status to 0 (success) if a license file is missing.",default:!1})},handler:async function(e){const t=e.ignoreNoLicense,n=Te(),{id:o}=await ee();S(`Workstation ID: ${o}`);let r=await Pe(n);0===r.length&&(r=function(e){const t=Ne(e),n=[];for(const[e,o]of t){const t=Re.find(t=>t.match(e));t&&n.push({name:e,productName:t.name,productCode:t.code,version:be(o),publishDate:-1,licensingDocsUrl:""})}return n}(n));let s=function(e){const t=new Set(e.flatMap(e=>[e.productCode,...e.productCodes||[],...e.redistributedBy||[]]).filter(Boolean));return Array.from(t.values())}(r);0===s.length&&(A("No Telerik or Kendo UI product references detected in project.\n  Consult the product documentation or contact support at https://prgress.co/3Pzpwvf"),s=U);const a=De();if(!1===a.success){try{await async function(e){const t=$e(e);for(const e of t)await tt({productVersion:e.version,productCode:e.productCode})}(r)}catch(e){S(`Failed to send telemetry: ${e.message}`)}const e="TKL002: "+a.message;if(t)return void $(e);throw new se(e,1)}let u;try{u=await re(a.value,G);const e=M(u.iat).toLocaleString();$(`Telerik and Kendo UI License Key found at: ${a.source}\n  License issued at ${e} to ${u.aud}`)}catch(e){const t=`Corrupted Telerik and Kendo UI License Key content in ${a.source}\n  Download a new copy of the license key from ${v}`;throw new se(t,2)}if(r.length>0){const e=Fe(u,r);for(const t of e.productLicenses.values())S(`Resolved license for ${t.code}, ${t.type}, expires ${M(t.expiration).toISOString()}`);for(const t of e.productErrors.values())A(t.message,t.code);try{await async function(e,t){if(e.usageEvidence){for(const t of e.productLicenses.values()){for(const n of e.productVersions)F(n)===t.code&&await Qe(t,e.usageEvidence,n.version);_e(e.productNames.get(t.code),t)}for(const n of e.productErrors.values())for(const o of e.productVersions)o.productName===n.productName&&await Ze({licenseKey:t,licenseEvidence:n.licenseEvidence,licenseErrorCode:n.code,usageEvidence:e.usageEvidence,productVersion:o.version,productCode:o.productCode})}}(e,u)}catch(e){S(`Failed to send telemetry: ${e.message}`)}}try{We(u,s),function(){const e=Te(),t=c.resolve(e,".next/cache");i.existsSync(t)&&A(`Next.js cache detected in ${t}\n  Delete the cache directory to apply the license key in production builds.`)}()}catch(e){throw console.error(e),new se("Error while importing license.",3)}}},ot={command:"help",describe:"Prints this help message.",handler:()=>{}};var rt;!function(e){e.Trial="trial",e.Subscription="subscription",e.Perpetual="perpetual"}(rt||(rt={}));const st={command:"info",describe:"Prints information about the current license.",handler:async function(){console.log("Looking up your Telerik License key file...");const e=De();if(!1===e.success)return void console.error(`License key file not found: ${e.message}`);let t;console.log(`License key file found: ${e.source}\n`);try{t=await re(e.value,G);const n=M(t.iat).toLocaleString();console.log(`  License key:\n     Audience: ${t.aud}\n     Issued At: ${n}\n     License Id: ${t.licenseId}\n     Used Id: ${t.userId}`)}catch(e){return void console.log(`Corrupted Telerik and Kendo UI License Key content\nDownload a new copy of the license key from ${v}`)}(function(e){const t=Ve(e);if(0===t.length)return void console.log("  No license evidences found in the License Key.\n");console.log("     Products:");for(const e of t){if("usage"===e.type)continue;const t=N[e.code]||e.code;console.log(`       ${t}`),console.log(`       ${ct(e)}\n`)}})(t),await async function(e){const t=Te(),n=await Pe(t);if(0===n.length)return void console.log("No product references detected in package.json\n");const o=Fe(e,n);if(o.productLicenses.size>0){console.log("  Licensed products in current project:");for(const e of o.productLicenses.values()){const t=N[e.code]||e.code,n=R[e.type],r=o.productVersions.find(t=>(t.productCode||t.productCodes[0])===e.code)?.version||"N/A";console.log(`      ${it} ${t} version ${r} (${n})\n`)}}if(o.productErrors.size>0){console.log("  Products with missing or expired licenses in current project:");for(const e of o.productErrors.values())console.log(`    ${at} ${e.productName}\n`)}}(t)}},it="✓",at="✗";function ct(e){const t=e.expiration?M(e.expiration).toLocaleDateString():"N/A",n=!!e.expiration&&Date.now()>=1e3*e.expiration,o=n?at:it;return e.type===rt.Trial?`${o} Trial license - ${n?"expired on":"expires on"} ${t}`:e.type===rt.Subscription?`${o} Subscription license - ${n?"expired on":"valid until"} ${t}`:e.type===rt.Perpetual?`${it} Perpetual license - valid for versions released before ${t}`:void 0}function ut(e,t="localhost"){return new Promise(n=>{const o=p.createServer();o.listen(e,t,()=>{o.close(()=>n(!0))}),o.on("error",()=>{n(!1)})})}class lt{constructor(e){const{preferredPort:t,host:n=I,callbackPath:o=T,timeout:r=C}=e;this.state={port:t,host:n,timeout:r,isListening:!1,callbackPath:o,startedAt:new Date,requestsReceived:0},this.httpServer=p.createServer((e,t)=>{this.handleRequest(e,t)}),this.validate()}validate(){if(this.state.port<=0||this.state.port>65535)throw new Error(`Invalid port number: ${this.state.port}`);if("localhost"!==this.state.host&&!dt(this.state.host))throw new Error("Host must be localhost to disable connections from external hosts");if(!this.state.callbackPath.startsWith("/"))throw new Error("Callback path must start with /")}tryStartOnPort(e){return new Promise((t,n)=>{this.httpServer?(this.httpServer.listen(e,this.state.host,()=>{t()}),this.httpServer.on("error",e=>{n(e)})):n(new Error("HTTP server not initialized"))})}setupTimeout(){this.timeoutId=setTimeout(()=>{if(this.callbackPromise){const e=(this.state.timeout||0)/1e3;this.callbackPromise.reject(new ue(`OAuth flow timed out after ${e} seconds`,"Please re-run the command and authenticate in the browser"))}this.stop()},this.state.timeout)}handleRequest(e,t){this.state.requestsReceived++,this.state.lastActivity=new Date;if(!dt(e.socket.remoteAddress))return t.statusCode=403,t.setHeader("Content-Type","text/plain"),void t.end("Forbidden: External connections not allowed");if("GET"!==e.method)return t.statusCode=405,t.setHeader("Content-Type","text/plain"),void t.end("Method Not Allowed");if(parseInt(e.headers["content-length"]||"0",10)>0)return t.statusCode=413,t.setHeader("Content-Type","text/plain"),void t.end("Payload Too Large");const n=new h.URL(e.url||"/",`http://${this.state.host}:${this.state.port}`);n.pathname===this.state.callbackPath?(this.handleCallback(n,t),this.stop()):(t.statusCode=404,t.setHeader("Content-Type","text/plain"),t.end("Not Found"))}handleCallback(e,t){const n={code:e.searchParams.get("code")||void 0,state:e.searchParams.get("state")||void 0,error:e.searchParams.get("error")||void 0,error_description:e.searchParams.get("error_description")||void 0};n.error?this.errorResponse(t,n):this.successResponse(t),this.callbackPromise&&(this.callbackPromise.resolve(n),this.callbackPromise=void 0)}errorResponse(e,t){e.statusCode=400,e.setHeader("Content-Type","text/html"),e.end((e=>`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="utf-8">\n    <title>Login Error</title>\n    <style>body{ font-family:system-ui,sans-serif; padding:2rem; }</style>\n</head>\n<body>\n    <h1>Telerik Licensing - Login Error ❌</h1>\n    <p>${e.error}</p>\n    <p>${e.error_description||"No description provided"}</p>\n    <p>You can close this window and return to the terminal.</p>\n</body>\n</html>\n`)(t))}successResponse(e){e.statusCode=200,e.setHeader("Content-Type","text/html"),e.end('\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="utf-8">\n    <title>Login Successful</title>\n    <style>body{ font-family:system-ui,sans-serif; padding:2rem; }</style>\n</head>\n<body>\n    <h1>Telerik Licensing - Login Successful ✅</h1>\n    <p>You can close this window and return to the terminal.</p>\n</body>\n</html>\n')}async start(){let e=this.state.port;e||(e=await async function(e=3e4,t=5e4){for(let n=0;n<10;n++){const n=Math.floor(Math.random()*(t-e+1))+e;if(await ut(n))return n}throw new Error(`No available ports found in range ${e}-${t} after 10 attempts`)}(),this.state.port=e),await this.tryStartOnPort(e),this.state.isListening=!0,this.setupTimeout()}waitForCallback(){if(!this.state.isListening)throw new Error("Server is not listening - call start() first");return new Promise((e,t)=>{this.callbackPromise={resolve:e,reject:t}})}async stop(){if(this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this.httpServer)return new Promise(e=>{this.httpServer.close(()=>{this.state.isListening=!1,e()})})}getCallbackUrl(){return`http://${this.state.host}:${this.state.port}${this.state.callbackPath}`}getPort(){return this.state.port}isListening(){return this.state.isListening}getRequestCount(){return this.state.requestsReceived}}function dt(e){return"127.0.0.1"===e||"::1"===e||"::ffff:127.0.0.1"===e}var pt;!function(e){e.WAITING_FOR_AUTH="waiting",e.CODE_RECEIVED="code_received",e.AUTHENTICATED="authenticated"}(pt||(pt={}));class ht{constructor(e){!function(){if(!q.CLIENT_ID)throw new Error("OAuth CLIENT_ID not configured");if(!q.CLIENT_SECRET)throw new Error("OAuth CLIENT_SECRET not configured");if(!q.AUTHORIZATION_URL)throw new Error("OAuth AUTHORIZATION_URL not configured");if(!q.TOKEN_URL)throw new Error("OAuth TOKEN_URL not configured");try{new URL(q.AUTHORIZATION_URL),new URL(q.TOKEN_URL)}catch(e){throw new Error("Invalid OAuth URL configuration")}}(),this.redirectUrl=e,this.state=this.generateStateParameter(),this.authorizationUrl=this.generateAuthorizationUrl()}handleCallback(e){const{code:t,state:n,error:o,error_description:r}=e;if(o){throw new ie(r||`OAuth error: ${o}`,"Please try authenticating again")}if(!t)throw new ie("No authorization code received","The OAuth callback was incomplete");if(!n)throw new ie("No state parameter received","The OAuth callback was incomplete");try{this.setAuthorizationCode(t,n),S(`Authorization code received: ${t.substring(0,10)}...`)}catch(o){throw new ie(o.message,"Possible security issue - please try again")}}async getAccessToken(){if(this.accessToken)return S("Returning cached access token"),this.accessToken;if(!this.hasAuthorizationCode())throw new ie("No authorization code available","Complete the OAuth flow first");return S("Access token requested, exchanging code for token..."),await this.exchangeCodeForToken(),this.accessToken}generateAuthorizationUrl(){const e=new URLSearchParams({client_id:q.CLIENT_ID,response_type:"code",redirect_uri:this.redirectUrl,state:this.state});return this.updateStatus(pt.WAITING_FOR_AUTH),`${q.AUTHORIZATION_URL}?${e.toString()}`}async exchangeCodeForToken(){if(!this.hasAuthorizationCode())throw new ie("No authorization code available","Complete the OAuth flow first");const e=this.getAuthorizationCode();S("Exchanging authorization code for access token");try{const r={grant_type:"authorization_code",code:e,redirect_uri:this.redirectUrl,client_id:q.CLIENT_ID},s={"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",...(n=q.CLIENT_ID,o=q.CLIENT_SECRET,{Authorization:`Basic ${Buffer.from(`${n}:${o}`).toString("base64")}`})};S(`Making token request to ${q.TOKEN_URL}`);const i=await ye(q.TOKEN_URL,{method:"POST",headers:s,body:(t=r,Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&"))});if(200!==i.status){if(i.status>=400&&i.status<500){let e="";try{const t=JSON.parse(i.body);e=t.error_description||t.error||"Unknown error"}catch{e=`HTTP ${i.status} ${i.statusText}`}throw new ie(`Token exchange failed: ${e}`,"Please try authenticating again")}throw new ae(`Token service error: HTTP ${i.status}`,"The authentication service may be temporarily unavailable. Please try again later.")}{const e=JSON.parse(i.body);this.validateTokenResponse(e),this.setAccessToken(e.access_token),S(`Access token received, expires in ${e.expires_in||"unknown"} seconds`)}}catch(e){if(e instanceof ie||e instanceof ae)throw e;throw new ae(`Failed to exchange authorization code: ${e.message}`,"Check your internet connection and try again")}var t,n,o}validateTokenResponse(e){if(!e.access_token)throw new ie("Invalid token response: missing access_token");if(e.token_type&&"bearer"!==e.token_type.toLowerCase())throw new ie(`Unsupported token type: ${e.token_type}`);3!==e.access_token.split(".").length&&A("Access token does not appear to be a valid JWT")}generateStateParameter(){return r.randomBytes(16).toString("hex")}updateStatus(e){this.status=e}setAuthorizationCode(e,t){if(t!==this.state)throw new Error("Invalid state parameter - possible CSRF attack");this.authorizationCode=e,this.updateStatus(pt.CODE_RECEIVED)}setAccessToken(e){this.accessToken=e,this.updateStatus(pt.AUTHENTICATED)}hasAuthorizationCode(){return!(!this.authorizationCode||this.status!==pt.CODE_RECEIVED)}getAuthorizationCode(){return this.authorizationCode}}const ft={command:"refresh",describe:"Downloads a new license key file after authenticating to telerik.com via a web browser.\nBy default, the license file is saved in the user's home directory.",builder:function(e){return e.option("output",{type:"string",description:"Specify custom license file path"}).option("timeout",{type:"number",description:"Authentication timeout, seconds",default:C/1e3}).option("port",{type:"number",description:"Preferred localhost port (random if not specified)"}).option("browser",{type:"boolean",description:"Automatically open browser",default:!0})},handler:async function(e){const{output:t,timeout:n,port:o,noBrowser:r}=function(e){const t={output:e.output,noBrowser:!e.browser,timeout:e.timeout,port:e.port};if(t.output&&/[<>:"|?*]/.test(t.output))throw new Error(`Invalid characters in output filename: ${t.output}`);if(isNaN(t.timeout)||t.timeout<=0)throw new Error("--timeout must be a positive number");if(t.timeout>0&&(t.timeout*=1e3),void 0!==t.port&&(t.port<=0||t.port>65535))throw new Error("--port must be a valid port number (1-65535)");return t}(e);S("Starting OAuth authentication flow..."),S("Starting local callback server...");const s=await async function(e){let t,n="";try{t=new lt(e),await t.start();const o=t.getPort();n=t.getCallbackUrl(),S(`Local callback server started on port ${o}`)}catch(e){throw new se(`Failed to start local server: ${e.message}`,5,"Try specifying a different port with --port")}return{callbackUrl:n,callbackData:t.waitForCallback().finally(async()=>{try{S("Stopping local callback server..."),await t.stop(),S("Server stopped successfully")}catch(e){throw P(`Error stopping server: ${e.message}`),new se(`Failed to stop server: ${e.message}`,5,"The server may still be running")}})}}({preferredPort:o,host:I,timeout:n}),i=s.callbackUrl;S(`Callback URL: ${i}`);const a=new ht(i),c=a.authorizationUrl;if(S(`Authorization URL: ${c}`),r)$("Browser opening disabled with --no-browser"),qe(c);else{await async function(e){$("Opening browser for authentication...");const t=await Ge({url:e});return t?$("Please complete authentication in your browser"):A(`Could not open browser automatically. Please open this URL manually:\n  ${e}`),t}(c)||S("Browser opening failed, showing manual instructions")}$(`Waiting for authentication (timeout in ${n/1e3}s)...`);const u=await s.callbackData;S("OAuth callback received"),$("Processing callback data..."),a.handleCallback(u);const l=await a.getAccessToken(),d=await Ie({accessToken:l,outputPath:t});$(`License key downloaded successfully to ${d.filePath} (${d.fileSize} bytes)`)}};async function mt(){try{const n=(new Date).getFullYear();return await e(t.hideBin(process.argv)).version(!1).wrap(null).strict().exitProcess(!1).scriptName("kendo-ui-license").usage(`Progress Kendo UI Licensing utility for NPM packages\nCopyright © ${n} Progress Software Corporation\n\nUsage: kendo-ui-license <command> [arguments]\n`).command(nt).command(ft).command(st).command(ot).demandCommand(1,"Please specify a command").fail((e,t,n)=>{if("Please specify a command"!==e)throw new ce(e);console.log(n.help())}).parseAsync(),0}catch(e){if(e instanceof se)return P(function(e){let t=`${e.message}`;return e instanceof se&&e.suggestion&&(t+=`\n ${e.suggestion}`),t}(e)),e.exitCode;if(e instanceof Error)return P(`An unexpected error occurred: ${e.message}`),S(`Stack trace: ${e.stack}`),3}}(async()=>{const e=await mt();process.exitCode=e})();
